%% prepare workspace
clear; close all;

addpath(genpath('../'));
addpath('../../cal')
addpath('../../src')
addpath('../../../unmix')
addpath('../../../unmix/src')
load ocean
Fs = {'FontSize',12};
FS = {'FontSize',15};
FL = {'FontSize',18};
Ms = {'MarkerSize',8};
MS = {'MarkerSize',10};
ML = {'MarkerSize',12};
TX = {'Interpreter','latex'};
TL = {'TickLabelInterpreter','latex'};
LB = {'Location','best'};
LO = {'Location','bestoutside'};
%%
b = [32.6154    4.5000    1.5192   36.3654   10.8558    9.7500    0.5481         0    1.9231    1.9231];

A = [ 0    0.2200    4.0000   89.0200    6.7600         0         0         0         0         0
      0    5.3800    1.7300   89.1600    3.7300         0         0         0         0         0
      0    1.0900    0.8400   94.9300    3.1400         0         0         0         0         0

52.9200         0    4.0000   12.2000   28.9300    1.9500         0         0         0         0
53.3200         0    1.8900   18.0300   25.3200    1.4400         0         0         0         0
55.0000         0    0.9000   15.3700   28.1400    0.5900         0         0         0         0

53.4200         0    1.7900    7.4700   16.4000   20.1400    0.7800         0         0         0
54.5600         0    0.6500    9.3900   15.2300   18.8100    1.3600         0         0         0
55.4400         0    0.3100    8.3500   14.7400   19.0800    2.0800         0         0         0

      0   51.0322         0   42.5365    6.4313         0         0         0         0         0

      0         0         0         0         0   56.0000         0         0   42.0000         2

      0         0         0         0         0         0         0         0         0  100.0000];

A = A';

C = lsqregcmp(A, b,[0,0,0,0.0])*100

mFe_oxdfit = C*A.'/100

res_mFe = mFe_oxdfit-b

resnorm = rms(res_mFe)

% *** change first regularisation parameters (distribution even)
% 1. [0,     5,0,0.002] 
%       mmt	    tmt	       mgt	     chy	   fhy	     hyp     	mau    	fau	       aug
% C = 0.2046   36.4705    0.2046    2.2469    3.7591    2.2815   10.4019   19.4062   25.0247

% 2. [0.25,  5,0,0.002]
% C = 0.2046   36.4670    0.2046    2.1548    3.7850    2.3578   10.5858   19.4072   24.8332

% 3. [0.5,   5,0,0.002]  
% C = 0.2046   36.4637    0.2046    2.0700    3.8104    2.4275   10.7587   19.4072   24.6533

% 4. [0.75,  5,0,0.002]
% C = 0.2046   36.4605    0.2046    1.9918    3.8352    2.4913   10.9216   19.4064   24.4840

% 5. [1.00,  5,0,0.002]
% C = 0.2046   36.4574    0.2046    1.9196    3.8595    2.5498   11.0755   19.4049   24.3242


% *** change second regularisation parameters (minimise the jump in fitted fractions between adjacent end members)
% 1. [1.00,  0,   0,0.002]
% C = 0.2039   36.5890    0.2039    6.7184    1.3664    0.2039    5.2139   19.2222   30.2784

% 2. [1.00,  0.5, 0,0.002]
% C = 0.2040   36.4912    0.2040    5.0856    3.1615    0.2040    7.2929   19.1150   28.2419

% 3. [1.00,  1.0, 0,0.002]
% C = 0.2040   36.4478    0.2040    4.4306    3.8816    0.2040    8.1684   19.2398   27.2199

% 4. [1.00,  2.0, 0,0.002]
% C = 0.2040   36.4059    0.2040    3.8737    4.4993    0.2040    9.0244   19.3976   26.1871

% 5. [1.00,  5.0, 0,0.002] *
% C = 0.2046   36.4574    0.2046    1.9196    3.8595    2.5498   11.0755   19.4049   24.3242

% 6. [1.00,  10.0, 0,0.002]
% C = 0.2048   36.4186    0.2048    0.6268    3.4182    4.3211   12.3020   19.3466   23.1572


% 1. [1.00,  5,0,0]
% C = 0        36.6072         0    1.9275    3.8753    2.5603   11.1210   19.4846   24.4241

% 2. [0.25,  5,0,0]
% C = 0        36.6169         0    2.1636    3.8006    2.3675   10.6293   19.4869   24.9352
